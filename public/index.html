<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <title>Prayer Beam</title>

    <link rel="icon" type="image/png" href="icon.png" />
    <link rel="apple-touch-icon" href="icon.png" />
    <meta name="theme-color" content="#ffffff" />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Crimson+Pro:ital,wght@0,400;0,600;1,400&display=swap"
      rel="stylesheet"
    />

    <style>
      /* --- 1. PREMIUM DESIGN SYSTEM --- */
      :root {
        --primary-grad: linear-gradient(135deg, #ff512f 0%, #dd2476 100%);
        --primary-color: #dd2476;

        /* Light Theme (Glass) */
        --bg-body: #fdfdfd;
        --bg-mesh: radial-gradient(
            at 0% 0%,
            hsla(253, 16%, 7%, 1) 0,
            transparent 50%
          ),
          radial-gradient(at 50% 0%, hsla(225, 39%, 30%, 1) 0, transparent 50%),
          radial-gradient(at 100% 0%, hsla(339, 49%, 30%, 1) 0, transparent 50%);
        --glass-surface: rgba(255, 255, 255, 0.85);
        --glass-border: rgba(255, 255, 255, 0.5);
        --text-main: #1d1d1f;
        --text-sec: #86868b;
        --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.05);
        --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.1);

        --nav-height: 65px;
        --safe-bottom: env(safe-area-inset-bottom, 20px);
      }

      [data-theme="dark"] {
        --bg-body: #000000;
        --glass-surface: rgba(28, 28, 30, 0.85);
        --glass-border: rgba(255, 255, 255, 0.1);
        --text-main: #f5f5f7;
        --text-sec: #86868b;
        --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
        outline: none;
        user-select: none;
      }

      body {
        margin: 0;
        font-family: "Inter", sans-serif;
        background: var(--bg-body);
        color: var(--text-main);
        overflow: hidden;
        height: 100vh;
        width: 100vw;
      }

      /* Background Mesh Gradient (Subtle) */
      .mesh-bg {
        position: fixed;
        top: -50%;
        left: -50%;
        right: -50%;
        bottom: -50%;
        background: radial-gradient(
            circle at 50% 10%,
            rgba(221, 36, 118, 0.08),
            transparent 40%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(255, 81, 47, 0.08),
            transparent 40%
          );
        z-index: -1;
        pointer-events: none;
        animation: pulse 10s ease-in-out infinite;
      }
      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      /* --- 2. APP SHELL --- */
      #app {
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      .screen {
        flex: 1;
        overflow-y: auto;
        overflow-x: hidden;
        padding-bottom: calc(var(--nav-height) + var(--safe-bottom) + 90px);
        display: none;
        opacity: 0;
        transform: scale(0.98);
        transition: 0.25s cubic-bezier(0.2, 0.8, 0.2, 1);
      }
      .screen.active {
        display: block;
        opacity: 1;
        transform: scale(1);
      }

      /* Glass Header */
      .glass-header {
        position: sticky;
        top: 0;
        z-index: 50;
        padding: 15px 20px;
        background: var(--glass-surface);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--glass-border);
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .app-title {
        font-size: 22px;
        font-weight: 800;
        background: var(--primary-grad);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      /* --- 3. COMPONENTS --- */

      /* Buttons */
      .btn-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: none;
        background: transparent;
        color: var(--text-main);
        font-size: 20px;
        cursor: pointer;
        transition: 0.2s;
      }
      .btn-icon:active {
        transform: scale(0.9);
        background: rgba(0, 0, 0, 0.05);
      }

      .btn-pill {
        background: var(--glass-surface);
        border: 1px solid var(--glass-border);
        padding: 10px 20px;
        border-radius: 30px;
        font-weight: 600;
        font-size: 14px;
        box-shadow: var(--shadow-sm);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--text-main);
      }
      .btn-pill:active {
        transform: scale(0.96);
      }

      /* Cards */
      .glass-card {
        background: var(--glass-surface);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow: var(--shadow-sm);
      }

      /* --- 4. NAVIGATION BAR --- */
      .tab-bar {
        position: fixed;
        bottom: 20px;
        left: 20px;
        right: 20px;
        height: 70px;
        background: var(--glass-surface);
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 1px solid var(--glass-border);
        border-radius: 35px;
        display: flex;
        justify-content: space-around;
        align-items: center;
        box-shadow: var(--shadow-lg);
        z-index: 1000;
      }
      .tab-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        color: var(--text-sec);
        background: none;
        border: none;
        font-size: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: 0.3s;
        width: 60px;
      }
      .tab-icon {
        font-size: 24px;
        margin-bottom: 2px;
        transition: 0.3s;
      }
      .tab-item.active {
        color: var(--primary-color);
      }
      .tab-item.active .tab-icon {
        transform: translateY(-3px);
      }

      /* --- 5. BIBLE READER --- */
      #bible-text-area {
        padding: 20px;
        max-width: 700px;
        margin: 0 auto;
      }
      .verse {
        font-family: "Crimson Pro", serif;
        font-size: 20px;
        line-height: 1.7;
        margin-bottom: 15px;
      }
      .v-num {
        font-family: "Inter";
        font-size: 11px;
        font-weight: 800;
        color: var(--primary-color);
        vertical-align: super;
        margin-right: 4px;
        opacity: 0.7;
      }

      .nav-controls {
        display: flex;
        gap: 15px;
        margin-top: 40px;
        padding-bottom: 20px;
      }
      .nav-btn-big {
        flex: 1;
        padding: 15px;
        border-radius: 15px;
        border: none;
        font-weight: 700;
        background: var(--glass-surface);
        color: var(--text-main);
        box-shadow: var(--shadow-sm);
        cursor: pointer;
        font-size: 16px;
        border: 1px solid var(--glass-border);
      }
      .nav-btn-big:active {
        transform: scale(0.98);
      }
      .nav-btn-big.primary {
        background: var(--primary-grad);
        color: white;
        border: none;
      }

      /* --- 6. MINI PLAYER --- */
      #mini-player {
        position: fixed;
        bottom: 100px;
        left: 20px;
        right: 20px;
        background: rgba(20, 20, 20, 0.85);
        backdrop-filter: blur(20px);
        color: white;
        border-radius: 18px;
        padding: 12px;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        transform: translateY(150px);
        transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        z-index: 900;
      }
      #mini-player.show {
        transform: translateY(0);
      }
      .mp-img {
        width: 44px;
        height: 44px;
        background: var(--primary-grad);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
      }

      /* --- 7. BOTTOM SHEETS --- */
      .sheet-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.3);
        z-index: 2000;
        opacity: 0;
        pointer-events: none;
        transition: 0.3s;
      }
      .sheet-backdrop.active {
        opacity: 1;
        pointer-events: auto;
      }
      .sheet {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--bg-body);
        border-radius: 30px 30px 0 0;
        padding: 25px;
        transform: translateY(100%);
        transition: 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        max-height: 70vh;
        display: flex;
        flex-direction: column;
      }
      .sheet-backdrop.active .sheet {
        transform: translateY(0);
      }
      .sheet-bar {
        width: 40px;
        height: 5px;
        background: var(--text-sec);
        opacity: 0.2;
        border-radius: 10px;
        margin: 0 auto 20px auto;
      }

      .grid-books {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        overflow-y: auto;
      }
      .book-item {
        padding: 12px;
        background: var(--glass-surface);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        text-align: center;
        font-weight: 600;
        font-size: 13px;
        cursor: pointer;
      }
    </style>
  </head>
  <body data-theme="light">
    <div class="mesh-bg"></div>

    <div id="app">
      <div id="screen-home" class="screen active">
        <div class="glass-header">
          <div class="app-title">Prayer Beam</div>
          <button class="btn-icon">üîî</button>
        </div>

        <div style="padding: 20px">
          <div
            class="glass-card"
            style="
              background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
              border: none;
              color: #333;
            "
          >
            <div
              style="
                font-size: 12px;
                font-weight: 700;
                opacity: 0.6;
                margin-bottom: 10px;
                text-transform: uppercase;
                letter-spacing: 1px;
              "
            >
              Verse of the Day
            </div>
            <div
              style="
                font-family: 'Crimson Pro';
                font-size: 24px;
                font-weight: 600;
                line-height: 1.4;
                margin-bottom: 15px;
              "
            >
              "Your word is a lamp for my feet, a light on my path."
            </div>
            <div style="font-weight: 700; font-size: 14px">Psalm 119:105</div>
          </div>

          <h3 style="margin: 25px 0 15px 0">Quick Access</h3>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px">
            <div
              class="glass-card"
              onclick="Nav.to('songs')"
              style="text-align: center; cursor: pointer"
            >
              <div style="font-size: 32px; margin-bottom: 10px">üéµ</div>
              <div style="font-weight: 700">Lyrics</div>
            </div>
            <div
              class="glass-card"
              onclick="Nav.to('tv')"
              style="text-align: center; cursor: pointer"
            >
              <div style="font-size: 32px; margin-bottom: 10px">üì∫</div>
              <div style="font-weight: 700">TV</div>
            </div>
          </div>
        </div>
      </div>

      <div id="screen-bible" class="screen">
        <div class="glass-header">
          <button class="btn-pill" onclick="Sheet.open('books')">
            <span id="label-book">Genesis</span>
            <span id="label-chap" style="color: var(--primary-color)">1</span>
            <span>‚ñº</span>
          </button>
          <div style="display: flex; gap: 5px">
            <button class="btn-icon" onclick="AudioPlayer.playChapter()">
              üîä
            </button>
            <button class="btn-icon" onclick="Sheet.open('settings')">
              Aa
            </button>
          </div>
        </div>

        <div id="bible-text-area">
          <div
            style="text-align: center; margin-top: 50px; color: var(--text-sec)"
          >
            Loading Scripture...
          </div>
        </div>

        <div style="padding: 0 20px">
          <div class="nav-controls">
            <button class="nav-btn-big" onclick="Bible.nav(-1)">Prev</button>
            <button class="nav-btn-big primary" onclick="Bible.nav(1)">
              Next Chapter
            </button>
          </div>
        </div>
      </div>

      <div id="screen-songs" class="screen">
        <div class="glass-header">
          <div class="app-title">Worship Songs</div>
        </div>
        <div style="padding: 20px">
          <input
            type="text"
            placeholder="Search lyrics..."
            onkeyup="Songs.render(this.value)"
            style="
              width: 100%;
              padding: 15px;
              border-radius: 15px;
              border: 1px solid var(--glass-border);
              background: var(--glass-surface);
              font-size: 16px;
              margin-bottom: 20px;
            "
          />
          <div id="songs-list"></div>
        </div>
      </div>

      <div id="screen-tv" class="screen">
        <div class="glass-header">
          <div class="app-title">Prayer Beam TV</div>
        </div>
        <div style="padding: 20px">
          <div class="glass-card" style="padding: 0; overflow: hidden">
            <div
              style="
                position: relative;
                padding-bottom: 56.25%;
                height: 0;
                background: #000;
              "
            >
              <iframe
                style="
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                "
                src="https://www.youtube.com/embed/videoseries?list=PLpcEZmijMVLBVJlP4oPCukvrRo-5wB-0i"
                frameborder="0"
                allowfullscreen
              ></iframe>
            </div>
          </div>
          <div class="glass-card" style="text-align: center">
            <h3>Subscribe Channel</h3>
            <p style="color: var(--text-sec); margin-bottom: 20px">
              Watch latest sermons and live events.
            </p>
            <a
              href="https://www.youtube.com/@Prayer_Beam"
              target="_blank"
              class="nav-btn-big primary"
              style="display: inline-block; text-decoration: none"
              >Open YouTube</a
            >
          </div>
        </div>
      </div>
    </div>

    <div id="mini-player">
      <div class="mp-img">üîä</div>
      <div style="flex: 1">
        <div style="font-size: 14px; font-weight: 700">Audio Bible</div>
        <div style="font-size: 11px; opacity: 0.7" id="mp-text">Genesis 1</div>
      </div>
      <button
        class="btn-icon"
        style="color: white"
        onclick="AudioPlayer.stop()"
      >
        ‚èπ
      </button>
    </div>

    <nav class="tab-bar">
      <button class="tab-item active" onclick="Nav.to('home')">
        <span class="tab-icon">üè†</span> Home
      </button>
      <button class="tab-item" onclick="Nav.to('bible')">
        <span class="tab-icon">üìñ</span> Bible
      </button>
      <button class="tab-item" onclick="Nav.to('songs')">
        <span class="tab-icon">üéµ</span> Songs
      </button>
      <button class="tab-item" onclick="Nav.to('tv')">
        <span class="tab-icon">‚ñ∂Ô∏è</span> TV
      </button>
    </nav>

    <div id="sheet-overlay" class="sheet-backdrop" onclick="Sheet.close()">
      <div class="sheet" onclick="event.stopPropagation()">
        <div class="sheet-bar"></div>
        <div id="sheet-content"></div>
      </div>
    </div>

    <script>
      // --- 1. DATA (FULL 66 BOOKS) ---
      const BOOKS_EN = [
        "Genesis",
        "Exodus",
        "Leviticus",
        "Numbers",
        "Deuteronomy",
        "Joshua",
        "Judges",
        "Ruth",
        "1 Samuel",
        "2 Samuel",
        "1 Kings",
        "2 Kings",
        "1 Chronicles",
        "2 Chronicles",
        "Ezra",
        "Nehemiah",
        "Esther",
        "Job",
        "Psalms",
        "Proverbs",
        "Ecclesiastes",
        "Song of Solomon",
        "Isaiah",
        "Jeremiah",
        "Lamentations",
        "Ezekiel",
        "Daniel",
        "Hosea",
        "Joel",
        "Amos",
        "Obadiah",
        "Jonah",
        "Micah",
        "Nahum",
        "Habakkuk",
        "Zephaniah",
        "Haggai",
        "Zechariah",
        "Malachi",
        "Matthew",
        "Mark",
        "Luke",
        "John",
        "Acts",
        "Romans",
        "1 Corinthians",
        "2 Corinthians",
        "Galatians",
        "Ephesians",
        "Philippians",
        "Colossians",
        "1 Thessalonians",
        "2 Thessalonians",
        "1 Timothy",
        "2 Timothy",
        "Titus",
        "Philemon",
        "Hebrews",
        "James",
        "1 Peter",
        "2 Peter",
        "1 John",
        "2 John",
        "3 John",
        "Jude",
        "Revelation",
      ];
      const BOOKS_TE = [
        "‡∞Ü‡∞¶‡∞ø‡∞ï‡∞æ‡∞Ç‡∞°‡∞Æ‡±Å",
        "‡∞®‡∞ø‡∞∞‡±ç‡∞ó‡∞Æ‡∞ï‡∞æ‡∞Ç‡∞°‡∞Æ‡±Å",
        "‡∞≤‡±á‡∞µ‡±Ä‡∞Ø‡∞ï‡∞æ‡∞Ç‡∞°‡∞Æ‡±Å",
        "‡∞∏‡∞Ç‡∞ñ‡±ç‡∞Ø‡∞æ‡∞ï‡∞æ‡∞Ç‡∞°‡∞Æ‡±Å",
        "‡∞¶‡±ç‡∞µ‡∞ø‡∞§‡±Ä‡∞Ø‡±ã‡∞™‡∞¶‡±á‡∞∂‡∞ï‡∞æ‡∞Ç‡∞°‡∞Æ‡±Å",
        "‡∞Ø‡±Ü‡∞π‡±ã‡∞∑‡±Å‡∞µ",
        "‡∞®‡±ç‡∞Ø‡∞æ‡∞Ø‡∞æ‡∞ß‡∞ø‡∞™‡∞§‡±Å‡∞≤‡±Å",
        "‡∞∞‡±Ç‡∞§‡±Å",
        "1 ‡∞∏‡∞Æ‡±Ç‡∞Ø‡±á‡∞≤‡±Å",
        "2 ‡∞∏‡∞Æ‡±Ç‡∞Ø‡±á‡∞≤‡±Å",
        "1 ‡∞∞‡∞æ‡∞ú‡±Å‡∞≤‡±Å",
        "2 ‡∞∞‡∞æ‡∞ú‡±Å‡∞≤‡±Å",
        "1 ‡∞¶‡∞ø‡∞®‡∞µ‡±É‡∞§‡±ç‡∞§‡∞æ‡∞Ç‡∞§‡∞Æ‡±Å‡∞≤‡±Å",
        "2 ‡∞¶‡∞ø‡∞®‡∞µ‡±É‡∞§‡±ç‡∞§‡∞æ‡∞Ç‡∞§‡∞Æ‡±Å‡∞≤‡±Å",
        "‡∞é‡∞ú‡±ç‡∞∞‡∞æ",
        "‡∞®‡±Ü‡∞π‡±Ü‡∞Æ‡±ç‡∞Ø‡∞æ",
        "‡∞é‡∞∏‡±ç‡∞§‡±á‡∞∞‡±Å",
        "‡∞Ø‡±ã‡∞¨‡±Å",
        "‡∞ï‡±Ä‡∞∞‡±ç‡∞§‡∞®‡∞≤‡±Å",
        "‡∞∏‡∞æ‡∞Æ‡±Ü‡∞§‡∞≤‡±Å",
        "‡∞™‡±ç‡∞∞‡∞∏‡∞Ç‡∞ó‡∞ø",
        "‡∞™‡∞∞‡∞Æ‡∞ó‡±Ä‡∞§‡∞Æ‡±Å",
        "‡∞Ø‡±Ü‡∞∑‡∞Ø‡∞æ",
        "‡∞Ø‡∞ø‡∞∞‡±ç‡∞Æ‡∞ø‡∞Ø‡∞æ",
        "‡∞µ‡∞ø‡∞≤‡∞æ‡∞™‡∞µ‡∞æ‡∞ï‡±ç‡∞Ø‡∞Æ‡±Å‡∞≤‡±Å",
        "‡∞Ø‡±Ü‡∞π‡±Ü‡∞ú‡±ç‡∞ï‡±á‡∞≤‡±Å",
        "‡∞¶‡∞æ‡∞®‡∞ø‡∞Ø‡±á‡∞≤‡±Å",
        "‡∞π‡±ã‡∞∑‡±á‡∞Ø",
        "‡∞Ø‡±ã‡∞µ‡±á‡∞≤‡±Å",
        "‡∞Ü‡∞Æ‡±ã‡∞∏‡±Å",
        "‡∞ì‡∞¨‡∞¶‡±ç‡∞Ø‡∞æ",
        "‡∞Ø‡±ã‡∞®‡∞æ",
        "‡∞Æ‡±Ä‡∞ï‡∞æ",
        "‡∞®‡∞π‡±Ç‡∞Æ‡±Å",
        "‡∞π‡∞¨‡∞ï‡±ç‡∞ï‡±Ç‡∞ï‡±Å",
        "‡∞ú‡±Ü‡∞´‡∞®‡±ç‡∞Ø‡∞æ",
        "‡∞π‡∞ó‡±ç‡∞ó‡∞Ø‡∞ø",
        "‡∞ú‡±Ü‡∞ï‡∞∞‡±ç‡∞Ø‡∞æ",
        "‡∞Æ‡∞≤‡∞æ‡∞ï‡±Ä",
        "‡∞Æ‡∞§‡±ç‡∞§‡∞Ø‡∞ø",
        "‡∞Æ‡∞æ‡∞∞‡±ç‡∞ï‡±Å",
        "‡∞≤‡±Ç‡∞ï‡∞æ",
        "‡∞Ø‡±ã‡∞π‡∞æ‡∞®‡±Å",
        "‡∞Ö‡∞™‡±ä‡∞∏‡±ç‡∞§‡∞≤‡±Å‡∞≤ ‡∞ï‡∞æ‡∞∞‡±ç‡∞Ø‡∞Æ‡±Å‡∞≤‡±Å",
        "‡∞∞‡±ã‡∞Æ‡±Ä‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "1 ‡∞ï‡±ã‡∞∞‡∞ø‡∞Ç‡∞•‡±Ä‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "2 ‡∞ï‡±ã‡∞∞‡∞ø‡∞Ç‡∞•‡±Ä‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "‡∞ó‡∞≤‡∞§‡±Ä‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "‡∞é‡∞´‡±Ü‡∞∏‡±Ä‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "‡∞´‡∞ø‡∞≤‡∞ø‡∞™‡±ç‡∞™‡±Ä‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "‡∞ï‡±ä‡∞≤‡±ä‡∞∏‡±ç‡∞∏‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "1 ‡∞•‡±Ü‡∞∏‡±ç‡∞∏‡∞≤‡±ä‡∞®‡±Ä‡∞ï‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "2 ‡∞•‡±Ü‡∞∏‡±ç‡∞∏‡∞≤‡±ä‡∞®‡±Ä‡∞ï‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "1 ‡∞§‡∞ø‡∞Æ‡±ã‡∞§‡∞ø‡∞ï‡∞ø",
        "2 ‡∞§‡∞ø‡∞Æ‡±ã‡∞§‡∞ø‡∞ï‡∞ø",
        "‡∞§‡±Ä‡∞§‡±Å‡∞ï‡±Å",
        "‡∞´‡∞ø‡∞≤‡±á‡∞Æ‡±ã‡∞®‡±Å‡∞ï‡±Å",
        "‡∞π‡±Ü‡∞¨‡±ç‡∞∞‡±Ä‡∞Ø‡±Å‡∞≤‡∞ï‡±Å",
        "‡∞Ø‡∞æ‡∞ï‡±ã‡∞¨‡±Å",
        "1 ‡∞™‡±á‡∞§‡±Å‡∞∞‡±Å",
        "2 ‡∞™‡±á‡∞§‡±Å‡∞∞‡±Å",
        "1 ‡∞Ø‡±ã‡∞π‡∞æ‡∞®‡±Å",
        "2 ‡∞Ø‡±ã‡∞π‡∞æ‡∞®‡±Å",
        "3 ‡∞Ø‡±ã‡∞π‡∞æ‡∞®‡±Å",
        "‡∞Ø‡±Ç‡∞¶‡∞æ",
        "‡∞™‡±ç‡∞∞‡∞ï‡∞ü‡∞® ‡∞ó‡±ç‡∞∞‡∞Ç‡∞•‡∞Æ‡±Å",
      ];

      const SONGS_DB = [
        {
          t: "Yesayya Naa Pranama",
          l: "‡∞Ø‡±á‡∞∏‡∞Ø‡±ç‡∞Ø‡∞æ ‡∞®‡∞æ ‡∞™‡±ç‡∞∞‡∞æ‡∞£‡∞Æ‡∞æ - ‡∞ò‡∞®‡∞Æ‡±à‡∞® ‡∞∏‡±ç‡∞§‡±Å‡∞§‡∞ø‡∞ó‡∞æ‡∞®‡∞Æ‡∞æ...",
        },
        { t: "Neeve Hrudaya Saradhi", l: "‡∞®‡±Ä‡∞µ‡±á ‡∞π‡±É‡∞¶‡∞Ø ‡∞∏‡∞æ‡∞∞‡∞ß‡∞ø..." },
        { t: "Hosanna", l: "‡∞π‡±ã‡∞∏‡∞®‡±ç‡∞®‡∞æ.. ‡∞π‡±ã‡∞∏‡∞®‡±ç‡∞®‡∞æ.." },
      ];

      // --- 2. STATE ---
      let state = JSON.parse(localStorage.getItem("pb_v9")) || {
        lang: "te",
        bIdx: 0,
        cNum: 1,
        theme: "light",
      };

      window.onload = () => {
        document.body.setAttribute("data-theme", state.theme);
        Bible.load();
        Songs.render();
      };

      function save() {
        localStorage.setItem("pb_v9", JSON.stringify(state));
      }

      // --- 3. NAVIGATION ---
      const Nav = {
        to(screen) {
          document
            .querySelectorAll(".screen")
            .forEach((s) => s.classList.remove("active"));
          document.getElementById("screen-" + screen).classList.add("active");

          document
            .querySelectorAll(".tab-item")
            .forEach((b) => b.classList.remove("active"));
          // Simple index matching for active tab
          const ids = ["home", "bible", "songs", "tv"];
          document
            .querySelectorAll(".tab-item")
            [ids.indexOf(screen)].classList.add("active");
        },
      };

      // --- 4. BIBLE ENGINE ---
      const Bible = {
        async load() {
          const el = document.getElementById("bible-text-area");
          el.innerHTML =
            '<div style="text-align:center; padding:50px; opacity:0.5;">Loading...</div>';

          // Update Labels
          const bName =
            state.lang === "te" ? BOOKS_TE[state.bIdx] : BOOKS_EN[state.bIdx];
          document.getElementById("label-book").innerText = bName;
          document.getElementById("label-chap").innerText = state.cNum;

          // Fetch
          try {
            const engName = BOOKS_EN[state.bIdx];
            const res = await fetch(
              `https://cdn.jsdelivr.net/gh/aruljohn/Bible-telugu@master/${engName}.json`
            );
            const json = await res.json();

            // Handle Chapter Logic
            let chapters = json.chapters || json;
            if (!Array.isArray(chapters)) chapters = [chapters];

            if (state.cNum > chapters.length) state.cNum = 1; // Reset if out of bounds

            const verses =
              chapters[state.cNum - 1].verses || chapters[state.cNum - 1].verse;

            el.innerHTML = verses
              .map(
                (v) =>
                  `<div class="verse"><span class="v-num">${v.verse}</span>${v.text}</div>`
              )
              .join("");
          } catch (e) {
            el.innerHTML = "Error loading chapter. Check internet.";
          }
          save();
        },
        nav(dir) {
          let n = state.cNum + dir;
          if (n < 1) return;
          state.cNum = n;
          Bible.load();
          window.scrollTo(0, 0);
        },
      };

      // --- 5. AUDIO PLAYER ---
      const AudioPlayer = {
        playChapter() {
          const text = document
            .getElementById("bible-text-area")
            .innerText.replace(/\d+/g, "");
          window.speechSynthesis.cancel();
          const u = new SpeechSynthesisUtterance(text);
          u.lang = "te-IN";
          window.speechSynthesis.speak(u);

          document.getElementById("mini-player").classList.add("show");
          const bName =
            state.lang === "te" ? BOOKS_TE[state.bIdx] : BOOKS_EN[state.bIdx];
          document.getElementById(
            "mp-text"
          ).innerText = `${bName} ${state.cNum}`;
        },
        stop() {
          window.speechSynthesis.cancel();
          document.getElementById("mini-player").classList.remove("show");
        },
      };

      // --- 6. SONGS ---
      const Songs = {
        render(q = "") {
          const list = document.getElementById("songs-list");
          const query = q.toLowerCase();
          list.innerHTML = SONGS_DB.filter((s) =>
            s.t.toLowerCase().includes(query)
          )
            .map(
              (s) => `
                    <div class="glass-card" onclick="Sheet.openLyrics('${s.t}', '${s.l}')" style="display:flex; align-items:center; gap:15px; cursor:pointer;">
                        <div style="width:40px; height:40px; background:var(--primary-grad); border-radius:50%; display:flex; align-items:center; justify-content:center; color:white;">üéµ</div>
                        <div style="font-weight:600;">${s.t}</div>
                    </div>
                `
            )
            .join("");
        },
      };

      // --- 7. BOTTOM SHEETS ---
      const Sheet = {
        open(type) {
          const el = document.getElementById("sheet-content");
          document.getElementById("sheet-overlay").classList.add("active");

          if (type === "books") {
            el.innerHTML = `<h3>Select Book</h3><div class="grid-books">
                        ${BOOKS_TE.map(
                          (b, i) =>
                            `<div class="book-item" onclick="state.bIdx=${i}; state.cNum=1; Bible.load(); Sheet.close()">${b}</div>`
                        ).join("")}
                    </div>`;
          } else if (type === "settings") {
            el.innerHTML = `<h3>Appearance</h3>
                    <div class="grid-books">
                        <div class="book-item" onclick="state.theme='light'; document.body.setAttribute('data-theme','light'); save()">‚òÄÔ∏è Light</div>
                        <div class="book-item" onclick="state.theme='dark'; document.body.setAttribute('data-theme','dark'); save()">üåô Dark</div>
                    </div>`;
          }
        },
        openLyrics(t, l) {
          document.getElementById("sheet-content").innerHTML = `
                    <h3 style="color:var(--primary-color);">${t}</h3>
                    <div style="white-space:pre-wrap; line-height:2; font-size:18px; max-height:60vh; overflow-y:auto;">${l}</div>
                `;
          document.getElementById("sheet-overlay").classList.add("active");
        },
        close() {
          document.getElementById("sheet-overlay").classList.remove("active");
        },
      };
    </script>
  </body>
</html>
